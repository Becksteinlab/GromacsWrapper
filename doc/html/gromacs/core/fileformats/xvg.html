

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Simple xmgrace XVG file format &mdash; GromacsWrapper 0.3.2 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.3.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/GromacsWrapper_logo_32x32.ico"/>
    <link rel="top" title="GromacsWrapper 0.3.2 documentation" href="../../../index.html" />
    <link rel="up" title="gromacs.formats – Accessing various files" href="../formats.html" />
    <link rel="next" title="Gromacs XPM file format" href="xpm.html" />
    <link rel="prev" title="gromacs.formats – Accessing various files" href="../formats.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="xpm.html" title="Gromacs XPM file format"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../formats.html" title="gromacs.formats – Accessing various files"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">GromacsWrapper 0.3.2 documentation</a> &raquo;</li>
          <li><a href="../../../gromacs.html" >GromacsWrapper package</a> &raquo;</li>
          <li><a href="../../core.html" >Gromacs core modules</a> &raquo;</li>
          <li><a href="../formats.html" accesskey="U"><tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">gromacs.formats</span></tt> &#8211; Accessing various files</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/GromacsWrapper_logo_200x200.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Simple xmgrace XVG file format</a><ul>
<li><a class="reference internal" href="#errors">Errors</a></li>
<li><a class="reference internal" href="#plotting">Plotting</a><ul>
<li><a class="reference internal" href="#data-selection">Data selection</a></li>
<li><a class="reference internal" href="#coarse-grainining-of-data">Coarse grainining of data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#classes-and-functions">Classes and functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../formats.html"
                        title="previous chapter"><tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">gromacs.formats</span></tt> &#8211; Accessing various files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="xpm.html"
                        title="next chapter">Gromacs XPM file format</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/gromacs/core/fileformats/xvg.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-gromacs.fileformats.xvg"></span><div class="section" id="simple-xmgrace-xvg-file-format">
<h1>Simple xmgrace XVG file format<a class="headerlink" href="#simple-xmgrace-xvg-file-format" title="Permalink to this headline">¶</a></h1>
<p>Gromacs produces graphs in the <a class="reference external" href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a> (&#8220;xvg&#8221;) format. These are
simple multi-column data files. The class <a class="reference internal" href="#gromacs.fileformats.xvg.XVG" title="gromacs.fileformats.xvg.XVG"><tt class="xref py py-class docutils literal"><span class="pre">XVG</span></tt></a> encapsulates
access to such files and adds a number of methods to access the data
(as NumPy arrays), compute aggregates, or quickly plot it.</p>
<p>The <a class="reference internal" href="#gromacs.fileformats.xvg.XVG" title="gromacs.fileformats.xvg.XVG"><tt class="xref py py-class docutils literal"><span class="pre">XVG</span></tt></a> class is useful beyond reading xvg files. With the
<em>array</em> keyword or the <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.set" title="gromacs.fileformats.xvg.XVG.set"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.set()</span></tt></a> method one can load data from
an array instead of a file. The array should be simple &#8220;NXY&#8221; data
(typically: first column time or position, further columns scalar
observables). The data should be a NumPy <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.7)"><tt class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></tt></a> array
<tt class="docutils literal"><span class="pre">a</span></tt> with <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.shape.html#numpy.ndarray.shape" title="(in NumPy v1.7)"><tt class="xref py py-attr docutils literal"><span class="pre">shape</span></tt></a> <tt class="docutils literal"><span class="pre">(M,</span> <span class="pre">N)</span></tt> where <em>M</em>-1 is the
number of observables and <em>N</em> the number of observations, e.g.the
number of time points in a time series. <tt class="docutils literal"><span class="pre">a[0]</span></tt> is the time or
position and <tt class="docutils literal"><span class="pre">a[1:]</span></tt> the <em>M</em>-1 data columns.</p>
<div class="section" id="errors">
<h2>Errors<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.error" title="gromacs.fileformats.xvg.XVG.error"><tt class="xref py py-attr docutils literal"><span class="pre">XVG.error</span></tt></a> attribute contains the statistical error for
each timeseries. It is computed from the standard deviation of the
fluctuations from the mean and their correlation time. The parameters
for the calculations of the correlation time are set with
<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.set_correlparameters" title="gromacs.fileformats.xvg.XVG.set_correlparameters"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.set_correlparameters()</span></tt></a>.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.tcorrel" title="numkit.timeseries.tcorrel"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.tcorrel()</span></tt></a></p>
</div>
</div>
<div class="section" id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a> and <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.errorbar" title="gromacs.fileformats.xvg.XVG.errorbar"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.errorbar()</span></tt></a> methods are set up to
produce graphs of multiple columns simultaneously. It is
typically assumed that the first column in the selected (sub)array
contains the abscissa (&#8220;x-axis&#8221;) of the graph and all further columns
are plotted against the first one.</p>
<div class="section" id="data-selection">
<h3>Data selection<a class="headerlink" href="#data-selection" title="Permalink to this headline">¶</a></h3>
<p>Plotting from <a class="reference internal" href="#gromacs.fileformats.xvg.XVG" title="gromacs.fileformats.xvg.XVG"><tt class="xref py py-class docutils literal"><span class="pre">XVG</span></tt></a> is fairly flexible as one can always pass
the <em>columns</em> keyword to select which columns are to be
plotted. Assuming that the data contains <tt class="docutils literal"><span class="pre">[t,</span> <span class="pre">X1,</span> <span class="pre">X2,</span> <span class="pre">X3]</span></tt>, then one
can</p>
<ol class="arabic">
<li><p class="first">plot all observable columns (X1 to X3) against t:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xvg</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">plot only X2 against t:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xvg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p class="first">plot X2 and X3 against t:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xvg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p class="first">plot X1 against X3:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xvg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="coarse-grainining-of-data">
<h3>Coarse grainining of data<a class="headerlink" href="#coarse-grainining-of-data" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to <em>coarse grain the data</em> for plotting (which
typically results in visually smoothing the graph because noise is
averaged out).</p>
<p>Currently, two alternative algorithms to produce &#8220;coarse grained&#8221;
(decimated) graphs are implemented and can be selected with the
<em>method</em> keyword for the plotting functions in conjuction with
<em>maxpoints</em> (the number of points to be plotted):</p>
<ol class="arabic simple">
<li><strong>mean</strong> histogram (default) &#8212; bin the data (using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.regularized_function" title="numkit.timeseries.regularized_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.regularized_function()</span></tt></a> and compute the
mean for each bin. Gives the exact number of desired points
but the time data are whatever the middle of the bin is.</li>
<li><strong>smooth</strong> subsampled &#8212; smooth the data with a running average
(other windows like Hamming are also possible) and then pick data
points at a stepsize compatible with the number of data points
required. Will give exact times but not the exact number of data
points.</li>
</ol>
<p>For simple test data, both approaches give very similar output.</p>
<p>For the special case of periodic data such as angles, one can use the
circular mean (&#8220;circmean&#8221;) to coarse grain. In this case, jumps across
the -180º/+180º boundary are added as masked datapoints and no line is
drawn across the jump in the plot. (Only works with the simple
<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a> method at the moment, errorbars or range plots are
not implemented yet.)</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate" title="gromacs.fileformats.xvg.XVG.decimate"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate()</span></tt></a></p>
</div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>In this example we generate a noisy time series of a sine wave. We
store the time, the value, and an error. (In a real example, the
value might be the mean over multiple observations and the error might
be the estimated error of the mean.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gromacs.formats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">*</span><span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">*</span><span class="mf">0.05</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xvg</span> <span class="o">=</span> <span class="n">gromacs</span><span class="o">.</span><span class="n">formats</span><span class="o">.</span><span class="n">XVG</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot value for <em>all</em> time points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xvg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxpoints</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot bin-averaged (decimated) data with the errors, over 1000 points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xvg</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">maxpoints</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(see output in Figure <a class="reference internal" href="#figure-xvg-decimated-label"><em>Plot of Raw vs Decimated data</em></a>)</p>
<div class="figure align-right" id="figure-xvg-decimated-label" style="width: 40%">
<a class="reference internal image-reference" href="../../../_images/xvg_decimated.png"><img alt="plot of a raw noisy sin(x) graph versus its decimated version" src="../../../_images/xvg_decimated.png" style="width: 382.9px; height: 338.1px;" /></a>
<p class="caption"><strong>Plot of Raw vs Decimated data.</strong> Example of plotting raw data
(sine on 50,000 points, gray) versus the decimated graph (reduced
to 1000 points, red line). The errors were also decimated and
reduced to the errors within the 5% and the 95% percentile. The
decimation is carried out by histogramming the data in the desired
number of bins and then the data in each bin is reduced by either
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.mean.html#numpy.mean" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.mean()</span></tt></a> (for the value) or
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.scoreatpercentile.html#scipy.stats.scoreatpercentile" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.stats.scoreatpercentile()</span></tt></a> (for errors).</p>
</div>
<p>In principle it is possible to use other functions to decimate the
data. For <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a>, the <em>method</em> keyword can be changed (see
<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate" title="gromacs.fileformats.xvg.XVG.decimate"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate()</span></tt></a> for allowed <em>method</em> values). For
<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.errorbar" title="gromacs.fileformats.xvg.XVG.errorbar"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.errorbar()</span></tt></a>, the method to reduce the data values (typically
column 1) is fixed to &#8220;mean&#8221; but the errors (typically columns 2 and 3)
can also be reduced with <em>error_method</em> = &#8220;rms&#8221;.</p>
<p>If one wants to show the variation of the raw data together with the
decimated and smoothed data then one can plot the percentiles of the
deviation from the mean in each bin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xvg</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxpoints</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="n">demean</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The <em>demean</em> keyword indicates if fluctuations from the mean are
regularised <a class="footnote-reference" href="#demean" id="id1">[1]</a>. The method <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot_coarsened" title="gromacs.fileformats.xvg.XVG.plot_coarsened"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot_coarsened()</span></tt></a>
automates this approach and can plot coarsened data selected by the
<em>columns</em> keyword.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="demean" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>When <em>error_method</em> = &#8220;percentile&#8221; is selected for
<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.errorbar" title="gromacs.fileformats.xvg.XVG.errorbar"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.errorbar()</span></tt></a> then <em>demean</em> does not actually
force a regularisation of the fluctuations from the
mean. Instead, the (symmetric) percentiles are computed
on the full data and the error ranges for plotting are
directly set to the percentiles. In this way one can
easily plot the e.g. 10th-percentile to 90th-percentile
band (using keyword <em>percentile</em> = 10).</td></tr>
</tbody>
</table>
</div>
<div class="section" id="classes-and-functions">
<h2>Classes and functions<a class="headerlink" href="#classes-and-functions" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="gromacs.fileformats.xvg.XVG">
<em class="property">class </em><tt class="descclassname">gromacs.fileformats.xvg.</tt><tt class="descname">XVG</tt><big>(</big><em>filename=None</em>, <em>names=None</em>, <em>array=None</em>, <em>permissive=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that represents the numerical data in a grace xvg file.</p>
<p>All data must be numerical. <tt class="xref py py-const docutils literal"><span class="pre">NAN</span></tt> and <tt class="xref py py-const docutils literal"><span class="pre">INF</span></tt> values are
supported via python&#8217;s <a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">float()</span></tt></a> builtin function.</p>
<p>The <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.array" title="gromacs.fileformats.xvg.XVG.array"><tt class="xref py py-attr docutils literal"><span class="pre">array</span></tt></a> attribute can be used to access the the
array once it has been read and parsed. The <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.ma" title="gromacs.fileformats.xvg.XVG.ma"><tt class="xref py py-attr docutils literal"><span class="pre">ma</span></tt></a>
attribute is a numpy masked array (good for plotting).</p>
<p>Conceptually, the file on disk and the XVG instance are considered the same
data. Whenever the filename for I/O (<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.read" title="gromacs.fileformats.xvg.XVG.read"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.read()</span></tt></a> and <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.write" title="gromacs.fileformats.xvg.XVG.write"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.write()</span></tt></a>) is
changed then the filename associated with the instance is also changed to reflect
the association between file and instance.</p>
<p>With the <em>permissive</em> = <tt class="docutils literal"><span class="pre">True</span></tt> flag one can instruct the file reader to skip
unparseable lines. In this case the line numbers of the skipped lines are stored
in <tt class="xref py py-attr docutils literal"><span class="pre">XVG.corrupted_lineno</span></tt>.</p>
<p>A number of attributes are defined to give quick access to simple statistics such as</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.mean" title="gromacs.fileformats.xvg.XVG.mean"><tt class="xref py py-attr docutils literal"><span class="pre">mean</span></tt></a>: mean of all data columns</li>
<li><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.std" title="gromacs.fileformats.xvg.XVG.std"><tt class="xref py py-attr docutils literal"><span class="pre">std</span></tt></a>: standard deviation</li>
<li><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.min" title="gromacs.fileformats.xvg.XVG.min"><tt class="xref py py-attr docutils literal"><span class="pre">min</span></tt></a>: minimum of data</li>
<li><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.max" title="gromacs.fileformats.xvg.XVG.max"><tt class="xref py py-attr docutils literal"><span class="pre">max</span></tt></a>: maximum of data</li>
<li><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.error" title="gromacs.fileformats.xvg.XVG.error"><tt class="xref py py-attr docutils literal"><span class="pre">error</span></tt></a>: error on the mean, taking correlation times into
account (see also <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.set_correlparameters" title="gromacs.fileformats.xvg.XVG.set_correlparameters"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.set_correlparameters()</span></tt></a>)</li>
<li><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.tc" title="gromacs.fileformats.xvg.XVG.tc"><tt class="xref py py-attr docutils literal"><span class="pre">tc</span></tt></a>: correlation time of the data (assuming a simple
exponential decay of the fluctuations around the mean)</li>
</ul>
</div></blockquote>
<p>These attributes are numpy arrays that correspond to the data columns,
i.e. :attr:<a href="#id2"><span class="problematic" id="id3">`</span></a>XVG.array`[1:].</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Only simple XY or NXY files are currently supported, <em>not</em>
Grace files that contain multiple data sets separated by &#8216;&amp;&#8217;.</li>
<li>Any kind of formatting (i.e. <strong class="program">xmgrace</strong> commands) is discarded.</li>
</ul>
</div>
<p>Initialize the class from a xvg file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments :</th><td class="field-body"><dl class="first last docutils">
<dt><em>filename</em></dt>
<dd><p class="first last">is the xvg file; it can only be of type XY or
NXY. If it is supplied then it is read and parsed
when <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.array" title="gromacs.fileformats.xvg.XVG.array"><tt class="xref py py-attr docutils literal"><span class="pre">XVG.array</span></tt></a> is accessed.</p>
</dd>
<dt><em>names</em></dt>
<dd><p class="first last">optional labels for the columns (currently only
written as comments to file); string with columns
separated by commas or a list of strings</p>
</dd>
<dt><em>array</em></dt>
<dd><p class="first last">read data from <em>array</em> (see <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.set" title="gromacs.fileformats.xvg.XVG.set"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.set()</span></tt></a>)</p>
</dd>
<dt><em>permissive</em></dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">False</span></tt> raises a <tt class="xref py py-exc docutils literal"><span class="pre">ValueError</span></tt> and logs and errior
when encountering data lines that it cannot parse.
<tt class="docutils literal"><span class="pre">True</span></tt> ignores those lines and logs a warning&#8212;this is
a risk because it might read a corrupted input file [<tt class="docutils literal"><span class="pre">False</span></tt>]</p>
</dd>
<dt><em>stride</em></dt>
<dd><p class="first last">Only read every <em>stride</em> line of data [1].</p>
</dd>
<dt><em>savedata</em></dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">True</span></tt> includes the data (<tt class="xref py py-attr docutils literal"><span class="pre">XVG.array`</span></tt> and
associated caches) when the instance is pickled (see
<a class="reference external" href="http://docs.python.org/library/pickle.html#pickle" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt></a>); this is oftens not desirable because the
data are already on disk (the xvg file <em>filename</em>) and the
resulting pickle file can become very big. <tt class="docutils literal"><span class="pre">False</span></tt> omits
those data from a pickle. [<tt class="docutils literal"><span class="pre">False</span></tt>]</p>
</dd>
<dt><em>metadata</em></dt>
<dd><p class="first last">dictionary of metadata, which is not touched by the class</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.array">
<tt class="descname">array</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent xvg data as a (cached) numpy array.</p>
<p>The array is returned with column-first indexing, i.e. for a data file with
columns X Y1 Y2 Y3 ... the array a will be a[0] = X, a[1] = Y1, ... .</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate">
<tt class="descname">decimate</tt><big>(</big><em>method</em>, <em>a</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Decimate data <em>a</em> to <em>maxpoints</em> using <em>method</em>.</p>
<p>If <em>a</em> is a 1D array then it is promoted to a (2, N) array
where the first column simply contains the index.</p>
<p>If the array contains fewer than <em>maxpoints</em> points or if
<em>maxpoints</em> is <tt class="docutils literal"><span class="pre">None</span></tt> then it is returned as it is. The
default for <em>maxpoints</em> is 10000.</p>
<p>Valid values for the reduction <em>method</em>:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;mean&#8221;, uses <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate_mean" title="gromacs.fileformats.xvg.XVG.decimate_mean"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate_mean()</span></tt></a> to coarse grain by
averaging the data in bins along the time axis</li>
<li>&#8220;circmean&#8221;, uses <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate_circmean" title="gromacs.fileformats.xvg.XVG.decimate_circmean"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate_circmean()</span></tt></a> to coarse
grain by calculating the circular mean of the data in bins
along the time axis. Use additional keywords <em>low</em> and
<em>high</em> to set the limits. Assumes that the data are in
degrees.</li>
<li>&#8220;min&#8221; and &#8220;max* select the extremum in each bin</li>
<li>&#8220;rms&#8221;, uses <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate_rms" title="gromacs.fileformats.xvg.XVG.decimate_rms"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate_rms()</span></tt></a> to coarse grain by
computing the root mean square sum of the data in bins
along the time axis (for averaging standard deviations and
errors)</li>
<li>&#8220;percentile&#8221; with keyword <em>per</em>: <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate_percentile" title="gromacs.fileformats.xvg.XVG.decimate_percentile"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate_percentile()</span></tt></a>
reduces data in each bin to the percentile <em>per</em></li>
<li>&#8220;smooth&#8221;, uses <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate_smooth" title="gromacs.fileformats.xvg.XVG.decimate_smooth"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate_smooth()</span></tt></a> to subsample
from a smoothed function (generated with a running average
of the coarse graining step size derived from the original
number of data points and <em>maxpoints</em>)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns :</th><td class="field-body">numpy array <tt class="docutils literal"><span class="pre">(M',</span> <span class="pre">N')</span></tt> from a <tt class="docutils literal"><span class="pre">(M',</span> <span class="pre">N)</span></tt> array
with <tt class="docutils literal"><span class="pre">M'</span> <span class="pre">==</span> <span class="pre">M</span></tt> (except when <tt class="docutils literal"><span class="pre">M</span> <span class="pre">==</span> <span class="pre">1</span></tt>, see above)
and <tt class="docutils literal"><span class="pre">N'</span> <span class="pre">&lt;=</span> <span class="pre">N</span></tt> (<tt class="docutils literal"><span class="pre">N'</span></tt> is <em>maxpoints</em>).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_circmean">
<tt class="descname">decimate_circmean</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_circmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> circmean-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates
the weighted circular mean in each bin as the decimated data,
using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.circmean_histogrammed_function" title="numkit.timeseries.circmean_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.circmean_histogrammed_function()</span></tt></a>. The
coarse grained time in the first column contains the centers
of the histogram time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<p>Keywords <em>low</em> and <em>high</em> can be used to set the
boundaries. By default they are [-pi, +pi].</p>
<p>This method returns a <strong>masked</strong> array where jumps are flagged
by an insertion of a masked point.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time and that the data are
in <strong>degrees</strong>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Breaking of arrays only works properly with a two-column
array because breaks are only inserted in the x-column
(a[0]) where y1 = a[1] has a break.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_error">
<tt class="descname">decimate_error</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> error-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates an
error estimate in each bin as the decimated data, using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.error_histogrammed_function" title="numkit.timeseries.error_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.error_histogrammed_function()</span></tt></a>. The
coarse grained time in the first column contains the centers
of the histogram time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.tcorrel" title="numkit.timeseries.tcorrel"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.tcorrel()</span></tt></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Assumes that the first column is time.</p>
<p class="last">Does not work very well because often there are too few
datapoints to compute a good autocorrelation function.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_max">
<tt class="descname">decimate_max</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> max-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates
the maximum in each bin as the decimated data, using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.max_histogrammed_function" title="numkit.timeseries.max_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.max_histogrammed_function()</span></tt></a>. The coarse grained
time in the first column contains the centers of the histogram
time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_mean">
<tt class="descname">decimate_mean</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> mean-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates
the weighted average in each bin as the decimated data, using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.mean_histogrammed_function" title="numkit.timeseries.mean_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.mean_histogrammed_function()</span></tt></a>. The coarse grained
time in the first column contains the centers of the histogram
time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_min">
<tt class="descname">decimate_min</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> min-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates
the minimum in each bin as the decimated data, using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.min_histogrammed_function" title="numkit.timeseries.min_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.min_histogrammed_function()</span></tt></a>. The coarse grained
time in the first column contains the centers of the histogram
time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_percentile">
<tt class="descname">decimate_percentile</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_percentile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> percentile-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates
the percentile <em>per</em> in each bin as the decimated data, using
<a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.percentile_histogrammed_function" title="numkit.timeseries.percentile_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.percentile_histogrammed_function()</span></tt></a>. The
coarse grained time in the first column contains the centers
of the histogram time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords :</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt><em>per</em></dt>
<dd>percentile as a percentage, e.g. 75 is the value that splits
the data into the lower 75% and upper 25%; 50 is the median [50.0]</dd>
</dl>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.regularized_function" title="numkit.timeseries.regularized_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.regularized_function()</span></tt></a> with <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.scoreatpercentile.html#scipy.stats.scoreatpercentile" title="(in SciPy v0.12)"><tt class="xref py py-func docutils literal"><span class="pre">scipy.stats.scoreatpercentile()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_rms">
<tt class="descname">decimate_rms</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_rms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data <em>a</em> rms-decimated on <em>maxpoints</em>.</p>
<p>Histograms each column into <em>maxpoints</em> bins and calculates
the root mean square sum in each bin as the decimated data,
using <a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.rms_histogrammed_function" title="numkit.timeseries.rms_histogrammed_function"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.rms_histogrammed_function()</span></tt></a>. The coarse
grained time in the first column contains the centers of the
histogram time.</p>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of  <em>maxpoints</em> points is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.decimate_smooth">
<tt class="descname">decimate_smooth</tt><big>(</big><em>a</em>, <em>maxpoints</em>, <em>window='flat'</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.decimate_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Return smoothed data <em>a</em> decimated on approximately <em>maxpoints</em> points.</p>
<ol class="arabic simple">
<li>Produces a smoothed graph using the smoothing window <em>window</em>;
&#8220;flat&#8221; is a running average.</li>
<li>select points at a step size approximatelt producing maxpoints</li>
</ol>
<p>If <em>a</em> contains &lt;= <em>maxpoints</em> then <em>a</em> is simply returned;
otherwise a new array of the same dimensions but with a
reduced number of points (close to <em>maxpoints</em>) is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes that the first column is time (which will <em>never</em>
be smoothed/averaged), except when the input array <em>a</em> is
1D and therefore to be assumed to be data at equidistance
timepoints.</p>
</div>
<p>TODO:
- Allow treating the 1st column as data</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.default_color_cycle">
<tt class="descname">default_color_cycle</tt><em class="property"> = ['black', 'red', 'blue', 'orange', 'magenta', 'cyan', 'yellow', 'brown', 'green']</em><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.default_color_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Default color cycle for <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot_coarsened" title="gromacs.fileformats.xvg.XVG.plot_coarsened"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot_coarsened()</span></tt></a>:
<tt class="docutils literal"><span class="pre">['black',</span> <span class="pre">'red',</span> <span class="pre">'blue',</span> <span class="pre">'orange',</span> <span class="pre">'magenta',</span> <span class="pre">'cyan',</span> <span class="pre">'yellow',</span> <span class="pre">'brown',</span> <span class="pre">'green']</span></tt></p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.default_extension">
<tt class="descname">default_extension</tt><em class="property"> = 'xvg'</em><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.default_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Default extension of XVG files.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.error">
<tt class="descname">error</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Error on the mean of the data, taking the correlation time into account.</p>
<p>See <a class="reference internal" href="../../../numkit/timeseries.html#frenkelsmit2002">[FrenkelSmit2002]</a> <a class="reference external" href="http://books.google.co.uk/books?id=XmyO2oRUg0cC&amp;pg=PA526">p526</a>:</p>
<blockquote>
<div>error = sqrt(2*tc*acf[0]/T)</div></blockquote>
<p>where acf() is the autocorrelation function of the fluctuations around
the mean, y-&lt;y&gt;, tc is the correlation time, and T the total length of
the simulation.</p>
<table class="docutils citation" frame="void" id="frenkelsmit2002" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[FrenkelSmit2002]</a></td><td>D. Frenkel and B. Smit, Understanding
Molecular Simulation. Academic Press, San
Diego 2002</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.errorbar">
<tt class="descname">errorbar</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.errorbar" title="Permalink to this definition">¶</a></dt>
<dd><p>errorbar plot for a single time series with errors.</p>
<p>Set <em>columns</em> keyword to select [x, y, dy] or [x, y, dx, dy],
e.g. <tt class="docutils literal"><span class="pre">columns=[0,1,2]</span></tt>. See <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a> for
details. Only a single timeseries can be plotted and the user
needs to select the appropriate columns with the <em>columns</em>
keyword.</p>
<p>By default, the data are decimated (see <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a>) for
the default of <em>maxpoints</em> = 10000 by averaging data in
<em>maxpoints</em> bins.</p>
<p>x,y,dx,dy data can plotted with error bars in the x- and
y-dimension (use <em>filled</em> = <tt class="docutils literal"><span class="pre">False</span></tt>).</p>
<p>For x,y,dy use <em>filled</em> = <tt class="docutils literal"><span class="pre">True</span></tt> to fill the region between
y±dy. <em>fill_alpha</em> determines the transparency of the fill
color. <em>filled</em> = <tt class="docutils literal"><span class="pre">False</span></tt> will draw lines for the error
bars. Additional keywords are passed to
<tt class="xref py py-func docutils literal"><span class="pre">pylab.errorbar()</span></tt>.</p>
<p>By default, the errors are decimated by plotting the 5% and
95% percentile of the data in each bin. The percentile can be
changed with the <em>percentile</em> keyword; e.g. <em>percentile</em> = 1
will plot the 1% and 99% perentile (as will <em>percentile</em> =
99).</p>
<p>The <em>error_method</em> keyword can be used to compute errors as
the root mean square sum (<em>error_method</em> = &#8220;rms&#8221;) across each
bin instead of percentiles (&#8220;percentile&#8221;). The value of the
keyword <em>demean</em> is applied to the decimation of error data
alone.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a> lists keywords common to both methods.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.ma">
<tt class="descname">ma</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.ma" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent data as a masked array.</p>
<p>The array is returned with column-first indexing, i.e. for a data file with
columns X Y1 Y2 Y3 ... the array a will be a[0] = X, a[1] = Y1, ... .</p>
<p>inf and nan are filtered via <tt class="xref py py-func docutils literal"><span class="pre">numpy.isfinite()</span></tt>.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.max">
<tt class="descname">max</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the data columns.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.maxpoints_default">
<tt class="descname">maxpoints_default</tt><em class="property"> = 10000</em><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.maxpoints_default" title="Permalink to this definition">¶</a></dt>
<dd><p>Aim for plotting around that many points</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.mean">
<tt class="descname">mean</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean value of all data columns.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.min">
<tt class="descname">min</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum of the data columns.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.parse">
<tt class="descname">parse</tt><big>(</big><em>stride=None</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and cache the file as a numpy array.</p>
<p>Store every <em>stride</em> line of data; if <tt class="docutils literal"><span class="pre">None</span></tt> then the class default is used.</p>
<p>The array is returned with column-first indexing, i.e. for a data file with
columns X Y1 Y2 Y3 ... the array a will be a[0] = X, a[1] = Y1, ... .</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.plot">
<tt class="descname">plot</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot xvg file data.</p>
<p>The first column of the data is always taken as the abscissa
X. Additional columns are plotted as ordinates Y1, Y2, ...</p>
<p>In the special case that there is only a single column then this column
is plotted against the index, i.e. (N, Y).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords :</th><td class="field-body"><dl class="first last docutils">
<dt><em>columns</em> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">Select the columns of the data to be plotted; the list
is used as a numpy.array extended slice. The default is
to use all columns. Columns are selected <em>after</em> a transform.</p>
</dd>
<dt><em>transform</em> <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd><p class="first last">function <tt class="docutils literal"><span class="pre">transform(array)</span> <span class="pre">-&gt;</span> <span class="pre">array</span></tt> which transforms
the original array; must return a 2D numpy array of
shape [X, Y1, Y2, ...] where X, Y1, ... are column
vectors.  By default the transformation is the
identity [<tt class="docutils literal"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x</span></tt>].</p>
</dd>
<dt><em>maxpoints</em> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">limit the total number of data points; matplotlib has issues processing
png files with &gt;100,000 points and pdfs take forever to display. Set to
<tt class="docutils literal"><span class="pre">None</span></tt> if really all data should be displayed. At the moment we simply
decimate the data at regular intervals. [10000]</p>
</dd>
<dt><em>method</em></dt>
<dd><p class="first last">method to decimate the data to <em>maxpoints</em>, see <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate" title="gromacs.fileformats.xvg.XVG.decimate"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate()</span></tt></a>
for details</p>
</dd>
<dt><em>color</em></dt>
<dd><p class="first last">single color (used for all plots); sequence of colors
(will be repeated as necessary); or a matplotlib
colormap (e.g. &#8220;jet&#8221;, see <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.cm</span></tt>). The
default is to use the <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.default_color_cycle" title="gromacs.fileformats.xvg.XVG.default_color_cycle"><tt class="xref py py-attr docutils literal"><span class="pre">XVG.default_color_cycle</span></tt></a>.</p>
</dd>
<dt><em>kwargs</em></dt>
<dd><p class="first last">All other keyword arguments are passed on to <tt class="xref py py-func docutils literal"><span class="pre">pylab.plot()</span></tt>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.plot_coarsened">
<tt class="descname">plot_coarsened</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.plot_coarsened" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot data like <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a> with the range of <strong>all</strong> data shown.</p>
<p>Data are reduced to <em>maxpoints</em> (good results are obtained
with low values such as 100) and the actual range of observed
data is plotted as a translucent error band around the mean.</p>
<p>Each column in <em>columns</em> (except the abscissa, i.e. the first
column) is decimated (with <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate" title="gromacs.fileformats.xvg.XVG.decimate"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate()</span></tt></a>) and the range
of data is plotted alongside the mean using
<a class="reference internal" href="#gromacs.fileformats.xvg.XVG.errorbar" title="gromacs.fileformats.xvg.XVG.errorbar"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.errorbar()</span></tt></a> (see for arguments). Additional
arguments:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Kewords :</th><td class="field-body"><dl class="first last docutils">
<dt><em>maxpoints</em></dt>
<dd><p class="first last">number of points (bins) to coarsen over</p>
</dd>
<dt><em>color</em></dt>
<dd><p class="first last">single color (used for all plots); sequence of colors
(will be repeated as necessary); or a matplotlib
colormap (e.g. &#8220;jet&#8221;, see <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.cm</span></tt>). The
default is to use the <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.default_color_cycle" title="gromacs.fileformats.xvg.XVG.default_color_cycle"><tt class="xref py py-attr docutils literal"><span class="pre">XVG.default_color_cycle</span></tt></a>.</p>
</dd>
<dt><em>method</em></dt>
<dd><p class="first last">Method to coarsen the data. See <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate" title="gromacs.fileformats.xvg.XVG.decimate"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate()</span></tt></a></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>The <em>demean</em> keyword has no effect as it is required to be <tt class="docutils literal"><span class="pre">True</span></tt>.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gromacs.fileformats.xvg.XVG.plot" title="gromacs.fileformats.xvg.XVG.plot"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.plot()</span></tt></a>, <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.errorbar" title="gromacs.fileformats.xvg.XVG.errorbar"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.errorbar()</span></tt></a> and <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.decimate" title="gromacs.fileformats.xvg.XVG.decimate"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.decimate()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.read">
<tt class="descname">read</tt><big>(</big><em>filename=None</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse xvg file <em>filename</em>.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.set">
<tt class="descname">set</tt><big>(</big><em>a</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <em>array</em> data from <em>a</em> (i.e. completely replace).</p>
<p>No sanity checks at the moment...</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.set_correlparameters">
<tt class="descname">set_correlparameters</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.set_correlparameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set and change the parameters for calculations with  correlation functions.</p>
<p>The parameters persist until explicitly changed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords :</th><td class="field-body"><dl class="first last docutils">
<dt><em>nstep</em></dt>
<dd><p class="first last">only process every <em>nstep</em> data point to speed up the FFT; if
left empty a default is chosen that produces roughly 25,000 data
points (or whatever is set in <em>ncorrel</em>)</p>
</dd>
<dt><em>ncorrel</em></dt>
<dd><p class="first last">If no <em>nstep</em> is supplied, aim at using <em>ncorrel</em> data points for
the FFT; sets <tt class="xref py py-attr docutils literal"><span class="pre">XVG.ncorrel</span></tt> [25000]</p>
</dd>
<dt><em>force</em></dt>
<dd><p class="first last">force recalculating correlation data even if cached values are
available</p>
</dd>
<dt><em>kwargs</em></dt>
<dd><p class="first last">see <a class="reference internal" href="../../../numkit/timeseries.html#numkit.timeseries.tcorrel" title="numkit.timeseries.tcorrel"><tt class="xref py py-func docutils literal"><span class="pre">numkit.timeseries.tcorrel()</span></tt></a> for other options</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.std">
<tt class="descname">std</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.std" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard deviation from the mean of all data columns.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.fileformats.xvg.XVG.tc">
<tt class="descname">tc</tt><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.tc" title="Permalink to this definition">¶</a></dt>
<dd><p>Correlation time of the data.</p>
<p>See <a class="reference internal" href="#gromacs.fileformats.xvg.XVG.error" title="gromacs.fileformats.xvg.XVG.error"><tt class="xref py py-meth docutils literal"><span class="pre">XVG.error()</span></tt></a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.fileformats.xvg.XVG.write">
<tt class="descname">write</tt><big>(</big><em>filename=None</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.XVG.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write array to xvg file <em>filename</em> in NXY format.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only plain files working at the moment, not compressed.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="gromacs.fileformats.xvg.break_array">
<tt class="descclassname">gromacs.fileformats.xvg.</tt><tt class="descname">break_array</tt><big>(</big><em>a</em>, <em>threshold=3.141592653589793</em>, <em>other=None</em><big>)</big><a class="headerlink" href="#gromacs.fileformats.xvg.break_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a array which masks jumps &gt;= threshold.</p>
<p>Extra points are inserted between two subsequent values whose
absolute difference differs by more than threshold (default is
pi).</p>
<p>Other can be a secondary array which is also masked according to
<em>a</em>.</p>
<p>Returns (<em>a_masked</em>, <em>other_masked</em>) (where <em>other_masked</em> can be
<tt class="docutils literal"><span class="pre">None</span></tt>)</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="xpm.html" title="Gromacs XPM file format"
             >next</a> |</li>
        <li class="right" >
          <a href="../formats.html" title="gromacs.formats – Accessing various files"
             >previous</a> |</li>
        <li><a href="../../../index.html">GromacsWrapper 0.3.2 documentation</a> &raquo;</li>
          <li><a href="../../../gromacs.html" >GromacsWrapper package</a> &raquo;</li>
          <li><a href="../../core.html" >Gromacs core modules</a> &raquo;</li>
          <li><a href="../formats.html" ><tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">gromacs.formats</span></tt> &#8211; Accessing various files</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2012, Oliver Beckstein, Jan Domański.
      Last updated on Aug 07, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>