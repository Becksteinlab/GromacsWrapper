

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>gromacs.core – Core functionality &mdash; GromacsWrapper 0.3.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/GromacsWrapper_logo_32x32.ico"/>
    <link rel="top" title="GromacsWrapper 0.3.1 documentation" href="../../index.html" />
    <link rel="up" title="Gromacs core modules" href="../core.html" />
    <link rel="next" title="gromacs.config – Configuration for GromacsWrapper" href="config.html" />
    <link rel="prev" title="Gromacs core modules" href="../core.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="config.html" title="gromacs.config – Configuration for GromacsWrapper"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../core.html" title="Gromacs core modules"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">GromacsWrapper 0.3.1 documentation</a> &raquo;</li>
          <li><a href="../../gromacs.html" >Gromacs package</a> &raquo;</li>
          <li><a href="../core.html" accesskey="U">Gromacs core modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/GromacsWrapper_logo_200x200.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">gromacs.core</span></tt> &#8211; Core functionality</a><ul>
<li><a class="reference internal" href="#input-and-output">Input and Output</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../core.html"
                        title="previous chapter">Gromacs core modules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="config.html"
                        title="next chapter"><tt class="docutils literal docutils literal"><span class="pre">gromacs.config</span></tt> &#8211; Configuration for GromacsWrapper</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/gromacs/core/core.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-gromacs.core"></span><div class="section" id="gromacs-core-core-functionality">
<h1><a class="reference internal" href="#module-gromacs.core" title="gromacs.core"><tt class="xref py py-mod docutils literal"><span class="pre">gromacs.core</span></tt></a> &#8211; Core functionality<a class="headerlink" href="#gromacs-core-core-functionality" title="Permalink to this headline">¶</a></h1>
<p>Here the basic command class <a class="reference internal" href="#gromacs.core.GromacsCommand" title="gromacs.core.GromacsCommand"><tt class="xref py py-class docutils literal"><span class="pre">GromacsCommand</span></tt></a> is defined. All Gromacs
command classes in <a class="reference internal" href="tools.html#module-gromacs.tools" title="gromacs.tools"><tt class="xref py py-mod docutils literal"><span class="pre">gromacs.tools</span></tt></a> are automatically generated from
it. The documentation of <a class="reference internal" href="#gromacs.core.GromacsCommand" title="gromacs.core.GromacsCommand"><tt class="xref py py-class docutils literal"><span class="pre">GromacsCommand</span></tt></a> applies to all wrapped Gromacs
commands and should be read by anyone using this package.</p>
<div class="section" id="input-and-output">
<span id="input-output-label"></span><h2>Input and Output<a class="headerlink" href="#input-and-output" title="Permalink to this headline">¶</a></h2>
<p>Each command wrapped by either <a class="reference internal" href="#gromacs.core.GromacsCommand" title="gromacs.core.GromacsCommand"><tt class="xref py py-class docutils literal"><span class="pre">GromacsCommand</span></tt></a> or <a class="reference internal" href="#gromacs.core.Command" title="gromacs.core.Command"><tt class="xref py py-class docutils literal"><span class="pre">Command</span></tt></a>
takes three additional keyword arguments: <em>stdout</em>, <em>stderr</em>, and
<em>input</em>. <em>stdout</em> and <em>stderr</em> determine how the command returns its own
output.</p>
<p>The <em>input</em> keyword is a string that is fed to the standard input of the
command (actually, <a class="reference external" href="http://docs.python.org/library/subprocess.html#subprocess.Popen.stdin" title="(in Python v2.7)"><tt class="xref py py-attr docutils literal"><span class="pre">subprocess.Popen.stdin</span></tt></a>). Or, if it is not string-like
then we assume it&#8217;s actually a file-like object that we can read from, e.g. a
<a class="reference external" href="http://docs.python.org/library/subprocess.html#subprocess.Popen.stdout" title="(in Python v2.7)"><tt class="xref py py-attr docutils literal"><span class="pre">subprocess.Popen.stdout</span></tt></a> or a <tt class="xref py py-class docutils literal"><span class="pre">File</span></tt>.</p>
<p>By setting the <em>stdout</em> and <em>stderr</em> keywords appropriately, one can have the
output simply printed to the screen (use <tt class="docutils literal"><span class="pre">True</span></tt>; this is the default,
although see below for the use of the <tt class="docutils literal"><span class="pre">capture_output</span></tt>
<a class="reference internal" href="environment.html#module-gromacs.environment" title="gromacs.environment"><tt class="xref py py-mod docutils literal"><span class="pre">gromacs.environment</span></tt></a> flag), capture in a python variable as a string for
further processing (use <tt class="docutils literal"><span class="pre">False</span></tt>), write to a file (use a <tt class="xref py py-class docutils literal"><span class="pre">File</span></tt>
instance) or as input for another command (e.g. use the
<a class="reference external" href="http://docs.python.org/library/subprocess.html#subprocess.Popen.stdin" title="(in Python v2.7)"><tt class="xref py py-attr docutils literal"><span class="pre">subprocess.Popen.stdin</span></tt></a>).</p>
<p>When writing setup- and analysis pipelines it can be rather cumbersome to have
the gromacs output on the screen. For these cases GromacsWrapper allows you to
change its behaviour globally. By setting the value of the
<a class="reference internal" href="environment.html#module-gromacs.environment" title="gromacs.environment"><tt class="xref py py-mod docutils literal"><span class="pre">gromacs.environment</span></tt></a> <a class="reference internal" href="environment.html#gromacs.environment.Flag" title="gromacs.environment.Flag"><tt class="xref py py-class docutils literal"><span class="pre">Flag</span></tt></a>
<tt class="docutils literal"><span class="pre">capture_output</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> (in the GromacsWrapper
<a class="reference internal" href="environment.html#gromacs.environment.flags" title="gromacs.environment.flags"><tt class="xref py py-data docutils literal"><span class="pre">gromacs.environment.flags</span></tt></a> registry)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">gromacs.environment</span>
<span class="n">gromacs</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s">&#39;capture_output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>all commands will capture their output (like <em>stderr</em> = <tt class="docutils literal"><span class="pre">False</span></tt> and <em>stdout</em>
= <tt class="docutils literal"><span class="pre">False</span></tt>). Explicitly setting these keywords overrides the global
default. The default value for <tt class="docutils literal"><span class="pre">flags['capture_output']</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>,
i.e. output is directed through STDOUT and STDERR.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">One downside of <tt class="docutils literal"><span class="pre">flags['capture_output']</span> <span class="pre">=</span> <span class="pre">True</span></tt> is that it becomes much
harder to debug scripts unless the script is written in such a way to show
the output when the command fails. Therefore, it is advisable to only
capture output on well-tested scripts.</p>
</div>
<p>A third value of <tt class="docutils literal"><span class="pre">capture_output</span></tt> is the value <tt class="docutils literal"><span class="pre">&quot;file&quot;</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gromacs</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s">&#39;capture_output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;file&quot;</span>
</pre></div>
</div>
<p>This writes the captured output to a file. The file name is specified in
<tt class="docutils literal"><span class="pre">flags['capture_output_filename'</span></tt> and defaults to
<em>&#8220;gromacs_captured_output.txt&#8221;</em>. This file is <em>over-written</em> for each
command. In this way one can investigate the output from the last command
(presumably because it failed). STDOUT and STDERR are captured into this file
by default. STDERR is printed first and then STDOUT, which does not necessarily
reflect the order of output one would see on the screen. If your code captures
STDOUT for further processing then an uncaptured STDERR is written to the
capture file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are some commands for which capturing output
(<tt class="docutils literal"><span class="pre">flags['capture_output']</span> <span class="pre">=</span> <span class="pre">True</span></tt>) might be problematic. If the command
produces a large or inifinite amount of data then a memory error will occur
because Python nevertheless stores the output internally first. Thus one
should avoid capturing progress output from
e.g. <a class="reference internal" href="tools.html#gromacs.tools.Mdrun" title="gromacs.tools.Mdrun"><tt class="xref py py-class docutils literal"><span class="pre">Mdrun</span></tt></a> unless the output has been throttled
appropriately.</p>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="gromacs.core.GromacsCommand">
<em class="property">class </em><tt class="descclassname">gromacs.core.</tt><tt class="descname">GromacsCommand</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.GromacsCommand" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for wrapping a g_* command.</p>
<p>Limitations: User must have sourced <tt class="docutils literal"><span class="pre">GMXRC</span></tt> so that the python script can
inherit the environment and find the gromacs programs.</p>
<p>The class doc string is dynamically replaced by the documentation of the
gromacs command when an instance is created.</p>
<p>Set up the command with gromacs flags as keyword arguments.</p>
<p>The following  are generic instructions; refer  to the Gromacs
command  usage information  that should  have  appeared before
this generic documentation.</p>
<p>As an example, a generic Gromacs command could use the following flags:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cmd</span> <span class="o">=</span> <span class="n">GromacsCommand</span><span class="p">(</span><span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;md1.xtc&#39;</span><span class="p">,</span><span class="s">&#39;md2.xtc&#39;</span><span class="p">],</span> <span class="n">o</span><span class="o">=</span><span class="s">&#39;processed.xtc&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>which would correspond to running the command in the shell as</p>
<div class="highlight-python"><pre>GromacsCommand -v -f md1.xtc md2.xtc -o processed.xtc -t 200</pre>
</div>
<p><strong>Gromacs command line arguments</strong></p>
<blockquote>
<div><p>Gromacs boolean switches (such as <tt class="docutils literal"><span class="pre">-v</span></tt>) are given as python
positional arguments (<tt class="docutils literal"><span class="pre">'v'</span></tt>) or as keyword argument (<tt class="docutils literal"><span class="pre">v=True</span></tt>);
note the quotes in the first case. Negating a boolean switch can be
done with <tt class="docutils literal"><span class="pre">'nov'</span></tt>, <tt class="docutils literal"><span class="pre">nov=True</span></tt> or <tt class="docutils literal"><span class="pre">v=False</span></tt> (and even <tt class="docutils literal"><span class="pre">nov=False</span></tt>
works as expected: it is the same as <tt class="docutils literal"><span class="pre">v=True</span></tt>).</p>
<p>Any Gromacs options that take parameters are handled as keyword
arguments. If an option takes multiple arguments (such as the
multi-file input <tt class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span> <span class="pre">...</span></tt>) then the list of files must be
supplied as a python list.</p>
<p>If a keyword has the python value <tt class="docutils literal"><span class="pre">None</span></tt> then it will <em>not</em> be
added to the Gromacs command line; this allows for flexible
scripting if it is not known in advance if an input file is
needed. In this case the default value of the gromacs tool
is used.</p>
<p>Keywords must be legal python keywords or the interpreter raises a
<tt class="xref py py-exc docutils literal"><span class="pre">SyntaxError</span></tt> but of course Gromacs commandline arguments are
not required to be legal python. In this case &#8220;quote&#8221; the option
with an underscore (<tt class="docutils literal"><span class="pre">_</span></tt>) and the underscore will be silently
stripped. For instance, <tt class="docutils literal"><span class="pre">-or</span></tt> translates to the illegal keyword
<tt class="docutils literal"><span class="pre">or</span></tt> so it must be underscore-quoted:</p>
<div class="highlight-python"><pre>cmd(...., _or='mindistres.xvg')</pre>
</div>
</div></blockquote>
<p><strong>Command execution</strong></p>
<blockquote>
<div><p>The command is executed with the <a class="reference internal" href="#gromacs.core.GromacsCommand.run" title="gromacs.core.GromacsCommand.run"><tt class="xref py py-meth docutils literal"><span class="pre">run()</span></tt></a> method or by
calling it as a function. The two next lines are equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cmd</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cmd</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>When the command is run one can override options that were given at
initialization or one can add additional ones. The same rules for
supplying Gromacs flags apply as described above.</p>
</div></blockquote>
<p><strong>Non-Gromacs keyword arguments</strong></p>
<blockquote>
<div>The other keyword arguments (listed below) are not passed on to the
Gromacs tool but determine how the command class behaves. <em>They are
only useful when instantiating a class</em>, i.e. they determine how
this tool behaves during all future invocations although it can be
changed by setting <a class="reference internal" href="#gromacs.core.GromacsCommand.failuremode" title="gromacs.core.GromacsCommand.failuremode"><tt class="xref py py-attr docutils literal"><span class="pre">failuremode</span></tt></a>. This is mostly of interest
to developers.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords :</th><td class="field-body"><dl class="first last docutils">
<dt><em>failure</em></dt>
<dd><p class="first">determines how a failure of the gromacs command is treated; it
can be one of the following:</p>
<dl class="last docutils">
<dt>&#8216;raise&#8217;</dt>
<dd><p class="first last">raises GromacsError if command fails</p>
</dd>
<dt>&#8216;warn&#8217;</dt>
<dd><p class="first last">issue a <tt class="xref py py-exc docutils literal"><span class="pre">GromacsFailureWarning</span></tt></p>
</dd>
<dt><tt class="docutils literal"><span class="pre">None</span></tt></dt>
<dd><p class="first last">just continue silently</p>
</dd>
</dl>
</dd>
<dt><em>doc</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">additional documentation []</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="gromacs.core.GromacsCommand.Popen">
<tt class="descname">Popen</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.GromacsCommand.Popen" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a special Popen instance (<a class="reference internal" href="#gromacs.core.PopenWithInput" title="gromacs.core.PopenWithInput"><tt class="xref py py-class docutils literal"><span class="pre">PopenWithInput</span></tt></a>).</p>
<p>The instance has its input pre-set so that calls to
<a class="reference internal" href="#gromacs.core.PopenWithInput.communicate" title="gromacs.core.PopenWithInput.communicate"><tt class="xref py py-meth docutils literal"><span class="pre">communicate()</span></tt></a> will not need to supply
input. This is necessary if one wants to chain the output from
one command to an input from another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo :</th><td class="field-body">Write example.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.GromacsCommand.commandline">
<tt class="descname">commandline</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.GromacsCommand.commandline" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the commandline that run() uses (without pipes).</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.core.GromacsCommand.failuremode">
<tt class="descname">failuremode</tt><a class="headerlink" href="#gromacs.core.GromacsCommand.failuremode" title="Permalink to this definition">¶</a></dt>
<dd><p>mode determines how the GromacsCommand behaves during failure</p>
<p>It can be one of the following:</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8216;raise&#8217;</dt>
<dd>raises GromacsError if command fails</dd>
<dt>&#8216;warn&#8217;</dt>
<dd>issue a <tt class="xref py py-exc docutils literal"><span class="pre">GromacsFailureWarning</span></tt></dd>
<dt><tt class="docutils literal"><span class="pre">None</span></tt></dt>
<dd>just continue silently</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.core.GromacsCommand.failuremodes">
<tt class="descname">failuremodes</tt><em class="property"> = ('raise', 'warn', None)</em><a class="headerlink" href="#gromacs.core.GromacsCommand.failuremodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Available failure modes.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.core.GromacsCommand.gmxdoc">
<tt class="descname">gmxdoc</tt><a class="headerlink" href="#gromacs.core.GromacsCommand.gmxdoc" title="Permalink to this definition">¶</a></dt>
<dd><p>Usage for the underlying Gromacs tool (cached).</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.GromacsCommand.help">
<tt class="descname">help</tt><big>(</big><em>long=False</em><big>)</big><a class="headerlink" href="#gromacs.core.GromacsCommand.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Print help; same as using <tt class="docutils literal"><span class="pre">?</span></tt> in <tt class="docutils literal"><span class="pre">ipython</span></tt>. long=True also gives call signature.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.GromacsCommand.run">
<tt class="descname">run</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.GromacsCommand.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the command; args/kwargs are added or replace the ones given to the constructor.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.GromacsCommand.transform_args">
<tt class="descname">transform_args</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.GromacsCommand.transform_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine arguments and turn them into gromacs tool arguments.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gromacs.core.Command">
<em class="property">class </em><tt class="descclassname">gromacs.core.</tt><tt class="descname">Command</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.Command" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap simple script or command.</p>
<p>Set up the command class.</p>
<p>The arguments can always be provided as standard positional
arguments such as</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">&quot;-c&quot;,</span> <span class="pre">&quot;config.conf&quot;,</span> <span class="pre">&quot;-o&quot;,</span> <span class="pre">&quot;output.dat&quot;,</span> <span class="pre">&quot;--repeats=3&quot;,</span> <span class="pre">&quot;-v&quot;,</span> <span class="pre">&quot;input.dat&quot;</span></tt></div></blockquote>
<p>In addition one can also use keyword arguments such as</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">c=&quot;config.conf&quot;,</span> <span class="pre">o=&quot;output.dat&quot;,</span> <span class="pre">repeats=3,</span> <span class="pre">v=True</span></tt></div></blockquote>
<p>These are automatically transformed appropriately according to
simple rules:</p>
<ul class="simple">
<li>Any single-character keywords are assumed to be POSIX-style
options and will be prefixed with a single dash and the value
separated by a space.</li>
<li>Any other keyword is assumed to be a GNU-style long option
and thus will be prefixed with two dashes and the value will
be joined directly with an equals sign and no space.</li>
</ul>
<p>If this does not work (as for instance for the options of the
UNIX <tt class="docutils literal"><span class="pre">find</span></tt> command) then provide options and values in the
sequence of positional arguments.</p>
<dl class="method">
<dt id="gromacs.core.Command.__call__">
<tt class="descname">__call__</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.Command.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Run command with the given arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rc</span><span class="p">,</span><span class="n">stdout</span><span class="p">,</span><span class="n">stderr</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>All positional parameters <em>args</em> and all gromacs <em>kwargs</em> are passed on
to the Gromacs command. input and output keywords allow communication
with the process via the python subprocess module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments :</th><td class="field-body"><dl class="first last docutils">
<dt><em>input</em> <span class="classifier-delimiter">:</span> <span class="classifier">string, sequence</span></dt>
<dd><p class="first last">to be fed to the process&#8217; standard input;
elements of a sequence are concatenated with
newlines, including a trailing one    [<tt class="docutils literal"><span class="pre">None</span></tt>]</p>
</dd>
<dt><em>stdin</em></dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">None</span></tt> or automatically set to <tt class="docutils literal"><span class="pre">PIPE</span></tt> if input given [<tt class="docutils literal"><span class="pre">None</span></tt>]</p>
</dd>
<dt><em>stdout</em></dt>
<dd><p class="first">how to handle the program&#8217;s stdout stream [<tt class="docutils literal"><span class="pre">None</span></tt>]</p>
<dl class="last docutils">
<dt>filehandle</dt>
<dd><p class="first last">anything that behaves like a file object</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">None</span></tt> or <tt class="docutils literal"><span class="pre">True</span></tt></dt>
<dd><p class="first last">to see  output on screen</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">False</span></tt> or <tt class="docutils literal"><span class="pre">PIPE</span></tt></dt>
<dd><p class="first last">returns the output as a string in  the stdout parameter</p>
</dd>
</dl>
</dd>
<dt><em>stderr</em></dt>
<dd><p class="first">how to handle the stderr stream [<tt class="docutils literal"><span class="pre">None</span></tt>]</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">STDOUT</span></tt></dt>
<dd><p class="first last">merges standard error with the standard out stream</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">False</span></tt> or <tt class="docutils literal"><span class="pre">PIPE</span></tt></dt>
<dd><p class="first last">returns the output as a string in the stderr return parameter</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">None</span></tt> or <tt class="docutils literal"><span class="pre">True</span></tt></dt>
<dd><p class="first last">keeps it on stderr (and presumably on screen)</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>Depending on the value of the GromacsWrapper flag
<tt class="xref py py-data docutils literal"><span class="pre">gromacs.environment.flags```['capture_output']`</span></tt> the above
default behaviour can be different.</p>
<p>All other kwargs are passed on to the Gromacs tool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns :</th><td class="field-body"><p class="first">The shell return code rc of the command is always returned. Depending
on the value of output, various strings are filled with output from the
command.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Notes :</th><td class="field-body"><p class="first">In order to chain different commands via pipes one must use the special
<a class="reference internal" href="#gromacs.core.PopenWithInput" title="gromacs.core.PopenWithInput"><tt class="xref py py-class docutils literal"><span class="pre">PopenWithInput</span></tt></a> object (see <a class="reference internal" href="#gromacs.core.GromacsCommand.Popen" title="gromacs.core.GromacsCommand.Popen"><tt class="xref py py-meth docutils literal"><span class="pre">GromacsCommand.Popen()</span></tt></a> method) instead of the simple
call described here and first construct the pipeline explicitly and then
call the <a class="reference internal" href="#gromacs.core.PopenWithInput.communicate" title="gromacs.core.PopenWithInput.communicate"><tt class="xref py py-meth docutils literal"><span class="pre">PopenWithInput.communicate()</span></tt></a> method.</p>
<p><tt class="docutils literal"><span class="pre">STDOUT</span></tt> and <tt class="docutils literal"><span class="pre">PIPE</span></tt> are objects provided by the <a class="reference external" href="http://docs.python.org/library/subprocess.html#subprocess" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">subprocess</span></tt></a> module. Any
python stream can be provided and manipulated. This allows for chaining
of commands. Use</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">PIPE</span><span class="p">,</span> <span class="n">STDOUT</span>
</pre></div>
</div>
<p>when requiring these special streams (and the special boolean
switches <tt class="docutils literal"><span class="pre">True</span></tt>/<tt class="docutils literal"><span class="pre">False</span></tt> cannot do what you need.)</p>
<p class="last">(TODO: example for chaining commands)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.Command.run">
<tt class="descname">run</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.Command.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the command; args/kwargs are added or replace the ones given to the constructor.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.Command.transform_args">
<tt class="descname">transform_args</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.Command.transform_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform arguments and return them as a list suitable for Popen.</p>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.Command.Popen">
<tt class="descname">Popen</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.Command.Popen" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a special Popen instance (<a class="reference internal" href="#gromacs.core.PopenWithInput" title="gromacs.core.PopenWithInput"><tt class="xref py py-class docutils literal"><span class="pre">PopenWithInput</span></tt></a>).</p>
<p>The instance has its input pre-set so that calls to
<a class="reference internal" href="#gromacs.core.PopenWithInput.communicate" title="gromacs.core.PopenWithInput.communicate"><tt class="xref py py-meth docutils literal"><span class="pre">communicate()</span></tt></a> will not need to supply
input. This is necessary if one wants to chain the output from
one command to an input from another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo :</th><td class="field-body">Write example.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gromacs.core.Command.help">
<tt class="descname">help</tt><big>(</big><em>long=False</em><big>)</big><a class="headerlink" href="#gromacs.core.Command.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Print help; same as using <tt class="docutils literal"><span class="pre">?</span></tt> in <tt class="docutils literal"><span class="pre">ipython</span></tt>. long=True also gives call signature.</p>
</dd></dl>

<dl class="attribute">
<dt id="gromacs.core.Command.command_name">
<tt class="descname">command_name</tt><em class="property"> = None</em><a class="headerlink" href="#gromacs.core.Command.command_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Derive a class from command; typically one only has to set <em>command_name</em>
to the name of the script or executable. The full path is required if it
cannot be found by searching <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PATH</span></tt>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gromacs.core.PopenWithInput">
<em class="property">class </em><tt class="descclassname">gromacs.core.</tt><tt class="descname">PopenWithInput</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#gromacs.core.PopenWithInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Popen class that knows its input.</p>
<ol class="arabic simple">
<li>Set up the instance, including all the input it shoould receive.</li>
<li>Call <a class="reference internal" href="#gromacs.core.PopenWithInput.communicate" title="gromacs.core.PopenWithInput.communicate"><tt class="xref py py-meth docutils literal"><span class="pre">PopenWithInput.communicate()</span></tt></a> later.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Some versions of python have a bug in the subprocess module
( <a class="reference external" href="http://bugs.python.org/issue5179">issue 5179</a> ) which does not clean up open file
descriptors. Eventually code (such as this one) fails with the
error:</p>
<blockquote>
<div><em>OSError: [Errno 24] Too many open files</em></div></blockquote>
<p class="last">A weak workaround is to increase the available number of open
file descriptors with <tt class="docutils literal"><span class="pre">ulimit</span> <span class="pre">-n</span> <span class="pre">2048</span></tt> and run analysis in
different scripts.</p>
</div>
<p>Initialize with the standard <a class="reference external" href="http://docs.python.org/library/subprocess.html#subprocess.Popen" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">subprocess.Popen</span></tt></a> arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords :</th><td class="field-body"><dl class="first last docutils">
<dt><em>input</em></dt>
<dd><p class="first last">string that is piped into the command</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="gromacs.core.PopenWithInput.communicate">
<tt class="descname">communicate</tt><big>(</big><em>use_input=True</em><big>)</big><a class="headerlink" href="#gromacs.core.PopenWithInput.communicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the command, using the input that was set up on __init__ (for <em>use_input</em> = <tt class="docutils literal"><span class="pre">True</span></tt>)</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="config.html" title="gromacs.config – Configuration for GromacsWrapper"
             >next</a> |</li>
        <li class="right" >
          <a href="../core.html" title="Gromacs core modules"
             >previous</a> |</li>
        <li><a href="../../index.html">GromacsWrapper 0.3.1 documentation</a> &raquo;</li>
          <li><a href="../../gromacs.html" >Gromacs package</a> &raquo;</li>
          <li><a href="../core.html" >Gromacs core modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2012, Oliver Beckstein, Jan Domański.
      Last updated on Dec 10, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>